#!/usr/bin/env node
"use strict"

/**
 * Note: the output of this file *is* linted. Don't forget the newlines!
 *
 * This file generates the browser tests' entry script.
 */

var fs = require("fs")
var path = require("path")
var glob = require("glob")

var p = path.resolve.bind(path, __dirname)

var stream = fs.createWriteStream(p("../helpers/browser-entry.js"))

stream.write("\"use strict\"\n")
stream.write("\n")
stream.write("/* global mocha */\n")
stream.write("\n")
stream.write("/**")
stream.write(" * Note: this is an autogenerated file, and edits won't be retained. If you\n") // eslint-disable-line max-len
stream.write(" * want to modify this file's contents, please make the relevant changes in\n") // eslint-disable-line max-len
stream.write(" * scripts/generate-browser-entry.js\n")
stream.write(" */")
stream.write("\n")

glob.sync(p("../test/**/*.js"), {
    nodir: true,
    ignore: ["test/cli/**"],
}).forEach(function (file) {
    stream.write("require(\"" + path.relative(p("../helpers"), file) + "\")\n")
})

stream.write("\n")
stream.write("mocha.run()\n") // eslint-disable-line max-len
